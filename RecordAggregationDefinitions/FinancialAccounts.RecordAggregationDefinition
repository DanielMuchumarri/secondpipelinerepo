<?xml version="1.0" encoding="UTF-8"?>
<RecordAggregationDefinition xmlns="http://soap.sforce.com/2006/04/metadata">
    <aggregateFromObject>FinServ__FinancialAccount__c</aggregateFromObject>
    <aggregateToObject>Account</aggregateToObject>
    <aggregationType>Record</aggregationType>
    <batchProcessingDefinition>RECORD_AGGREGATION_DEFINITION</batchProcessingDefinition>
    <description>Financial Account rollup config</description>
    <displayName>Financial accounts for members of a household</displayName>
    <recordAggregationObject>
        <associatedObject>AccountContactRelation</associatedObject>
        <developerName>AccountContactRelationObj</developerName>
        <filterLogic>1 AND 2 AND 3</filterLogic>
        <masterLabel>AccountContactRelationObj</masterLabel>
        <recordAggregationJoinCondition>
            <joinField>Contact</joinField>
            <navigationSequenceNumber>2</navigationSequenceNumber>
            <relatedJoinField>Id</relatedJoinField>
            <relatedRecordAggregationObject>ContactObj</relatedRecordAggregationObject>
            <type>Intermediate</type>
        </recordAggregationJoinCondition>
        <recordAggregationObjectFilter>
            <associatedObjectField>FinServ__PrimaryGroup__c</associatedObjectField>
            <operator>Equals</operator>
            <sequenceNumber>1</sequenceNumber>
            <value>true</value>
        </recordAggregationObjectFilter>
        <recordAggregationObjectFilter>
            <associatedObjectField>IsActive</associatedObjectField>
            <operator>Equals</operator>
            <sequenceNumber>2</sequenceNumber>
            <value>true</value>
        </recordAggregationObjectFilter>
        <recordAggregationObjectFilter>
            <associatedObjectField>IsDirect</associatedObjectField>
            <operator>Equals</operator>
            <sequenceNumber>3</sequenceNumber>
            <value>false</value>
        </recordAggregationObjectFilter>
    </recordAggregationObject>
    <recordAggregationObject>
        <associatedObject>Account</associatedObject>
        <developerName>AccountObj</developerName>
        <masterLabel>AccountObj</masterLabel>
        <recordAggregationJoinCondition>
            <joinField>Id</joinField>
            <navigationSequenceNumber>1</navigationSequenceNumber>
            <relatedJoinField>Account</relatedJoinField>
            <relatedRecordAggregationObject>AccountContactRelationObj</relatedRecordAggregationObject>
            <type>Intermediate</type>
        </recordAggregationJoinCondition>
    </recordAggregationObject>
    <recordAggregationObject>
        <associatedObject>Contact</associatedObject>
        <developerName>ContactObj</developerName>
        <masterLabel>ContactObj</masterLabel>
        <recordAggregationJoinCondition>
            <joinField>Account</joinField>
            <navigationSequenceNumber>3</navigationSequenceNumber>
            <relatedJoinField>FinServ__RelatedAccount__c</relatedJoinField>
            <relatedRecordAggregationObject>FinancialAccountRoleObj</relatedRecordAggregationObject>
            <type>Intermediate</type>
        </recordAggregationJoinCondition>
    </recordAggregationObject>
    <recordAggregationObject>
        <associatedObject>FinServ__FinancialAccount__c</associatedObject>
        <developerName>FinancialAccountObj</developerName>
        <masterLabel>FinancialAccountObj</masterLabel>
    </recordAggregationObject>
    <recordAggregationObject>
        <associatedObject>FinServ__FinancialAccountRole__c</associatedObject>
        <developerName>FinancialAccountRoleObj</developerName>
        <masterLabel>FinancialAccountRoleObj</masterLabel>
        <recordAggregationJoinCondition>
            <joinField>FinServ__FinancialAccount__c</joinField>
            <navigationSequenceNumber>4</navigationSequenceNumber>
            <relatedJoinField>Id</relatedJoinField>
            <relatedRecordAggregationObject>FinancialAccountObj</relatedRecordAggregationObject>
            <type>AggregateFrom</type>
        </recordAggregationJoinCondition>
    </recordAggregationObject>
    <status>Active</status>
</RecordAggregationDefinition>
